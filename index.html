<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>DEEBOOK | Ultra Sound Edition</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@700&display=swap" rel="stylesheet">
    <style>
        body { margin: 0; overflow: hidden; background: #000; cursor: none; font-family: 'Kanit', sans-serif; }
        canvas { display: block; position: fixed; top: 0; left: 0; z-index: 1; pointer-events: none; }
        
        #ui-layer {
            position: relative; z-index: 10; height: 100vh;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            color: white; pointer-events: none;
        }
        .profile-img {
            width: 150px; height: 150px; border-radius: 50%;
            border: 4px solid #fff; box-shadow: 0 0 20px #fff;
            pointer-events: auto;
        }
        h1 { font-size: 4rem; letter-spacing: 10px; text-shadow: 0 0 20px rgba(255,255,255,0.5); }
        #overlay {
            position: fixed; inset: 0; background: #000; z-index: 100;
            display: flex; align-items: center; justify-content: center; color: white;
            font-size: 1.5rem; letter-spacing: 2px; cursor: pointer;
            transition: 0.5s;
        }
    </style>
</head>
<body>

    <div id="overlay" onclick="start()">[ CLICK TO ACTIVATE SWORD & AUDIO ]</div>

    <div id="ui-layer">
        <img src="FB_IMG_1699721840964.jpg" class="profile-img" alt="Profile">
        <h1>DEEBOOK</h1>
        <p>THE ULTIMATE INTERACTIVE EXPERIENCE</p>
    </div>

    <script>
        let slashes = [];
        let particles = [];
        let canDraw = false;
        let swingSound;
        
        function preload() {
            // ผมใส่ลิงก์เสียงดาบฟันจากอินเทอร์เน็ตให้แล้วครับ รันได้ทันที!
            swingSound = new Audio('https://assets.mixkit.co/active_storage/sfx/2568/2568-preview.mp3'); 
            swingSound.load();
        }

        function start() {
            document.getElementById('overlay').style.opacity = '0';
            setTimeout(() => {
                document.getElementById('overlay').style.display = 'none';
            }, 500);
            
            canDraw = true;
            
            // ปลดล็อคระบบเสียง (บังคับ Play ครั้งแรกตามกฎเบราว์เซอร์)
            if (swingSound) {
                swingSound.play().then(() => {
                    swingSound.pause();
                    swingSound.currentTime = 0;
                }).catch(e => console.log("Audio ready!"));
            }
        }

        function setup() {
            createCanvas(windowWidth, windowHeight);
        }

        function windowResized() {
            resizeCanvas(windowWidth, windowHeight);
        }

        function draw() {
            if (!canDraw) return;
            clear();

            // วาดรอยฟัน
            for (let i = slashes.length - 1; i >= 0; i--) {
                let s = slashes[i];
                stroke(255, s.alpha);
                strokeWeight(s.weight);
                line(s.x1, s.y1, s.x2, s.y2);
                s.alpha -= 10;
                s.weight *= 0.9;
                if (s.alpha <= 0) slashes.splice(i, 1);
            }

            // วาดสะเก็ดไฟ
            for (let i = particles.length - 1; i >= 0; i--) {
                let p = particles[i];
                noStroke();
                fill(p.color, p.alpha);
                circle(p.x, p.y, p.size);
                p.x += p.vx;
                p.y += p.vy;
                p.alpha -= 5;
                if (p.alpha <= 0) particles.splice(i, 1);
            }

            drawSword(mouseX, mouseY);
        }

        function drawSword(x, y) {
            push();
            translate(x, y);
            rotate(radians(-5));
            noStroke();
            // Aura รอบดาบ
            for(let i=10; i>0; i--) {
                fill(255, 255, 255, 15 - i);
                ellipse(0, 0, i * 12, i * 3);
            }
            // ตัวดาบ
            stroke(255);
            strokeWeight(4);
            line(0, 0, -50, 50); 
            pop();
        }

        function mouseMoved() {
            if (!canDraw) return;
            
            let speed = dist(mouseX, mouseY, pmouseX, pmouseY);
            
            if (speed > 20) {
                // เพิ่มรอยฟัน
                slashes.push({
                    x1: mouseX, y1: mouseY,
                    x2: pmouseX, y2: pmouseY,
                    alpha: 255,
                    weight: map(speed, 0, 100, 2, 15)
                });

                // เล่นเสียงแบบ Dynamic (เสียงจะเปลี่ยนตามความเร็ว)
                if (swingSound) {
                    let s = swingSound.cloneNode();
                    let pitch = map(speed, 20, 100, 0.8, 2.0);
                    s.playbackRate = constrain(pitch, 0.8, 2.0);
                    s.volume = 0.3;
                    s.play();
                }
            }
        }

        function mousePressed() {
            if (!canDraw) return;
            // คลิกแล้วมีสะเก็ดไฟ
            for (let i = 0; i < 25; i++) {
                particles.push({
                    x: mouseX, y: mouseY,
                    vx: random(-6, 6), vy: random(-6, 6),
                    size: random(5, 12),
                    color: color(255, random(100, 255), 0),
                    alpha: 255
                });
            }
        }
    </script>
</body>
</html>

